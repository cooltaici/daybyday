# DeepLab: Semantic Image Segmentation withDeep Convolutional Nets, Atrous Convolution,and Fully Connected CRFs
**地址**：https://arxiv.org/pdf/1606.00915.pdf
###摘要
在这项工作中有三个主要贡献。
- 第一，使用上采样滤波器进行卷积，或者将“多孔 convolution”应用在密集预测任务。多孔卷积允许我们在DCNN计算特征响应时明确地控制响应的分辨率。能有效地扩大滤波器的视野以并入更多的上下文而不增加参数的数量或计算量。 
- 第二，提出多孔空间金字塔池化(ASPP)，在多尺度上鲁棒地分割物体。ASPP使用多个采样率和有效视野的滤波器来探测进入的卷积特征层，从多尺度捕获物体以及图像上下文。 
- 第三，通过合并DCNN和概率图模型的方法，增强物体边界的定位。通常在DCNN中采用最大池化和下采样方法实现不变性，但对定位精度有一定的限制。我们通过将最终的DCNN层的响应与完全连接的条件随机场(CRF)相结合来克服这一点，定性和定量地提高定位性能。我们提出的“DeepLab”系统在PASCAL VOC-2012语义图像分割任务中达到了新的最新技术，在测试集中达到79.7％的mIOU，并将结果推广到另外三个数据集:PASCAL-Context，PASCAL-Person Part和Cityscapes。所有代码已经开源。
### 引言
#### DCNN应用于语义图像分割中的三个挑战
&emsp;**挑战一**：是由连续DCNN层中的最大池化和下采样(滑动步长)的重复组合引起的。当DCNN以完全卷积方式使用时，会导致特征图的空间分辨率显著降低。
&emsp;**挑战二**：是由于不同scale物体的存在。通常的做法是对同样的图片，采用不同scale的DCNN版本，但这样做的效率太低了。我们提出了一种高效地计算方案:在卷积之前以多个采样率重新采样特定的特征层。这相当于用具有互补的有效视野的多个滤波器探测原始图像，从而在多个尺度上捕获物体以及有用的图像上下文。与实际重新采样特征不同，我们有效地使用具有不同采样率的多个并行的多孔卷积层来实现该映射，称之为(ASPP)技术。
&emsp;**挑战三**:涉及到以物体为中心的分类器所需要的空间变换的不变性，固有地限制了DCNN的空间精度。一种减轻此问题的方法是当计算最终的分割结果时使用跳跃层(skip-layers)从多个网络层提取“hyper-column”超抽象特征。我们探索出一种替代方法，并证明这种方法是非常有效的。特别地，通过使用全连接的条件随机场(CRF)来提高模型捕获精细细节的能力。CRF广泛用于语义分割，将从像素和边缘或超像素的局部交互中捕获低阶信息的多路分类器计算得到的类分数结合起来。虽然建模分段依赖性[26], [27], [28]和/或分割用的高阶依赖性[29, 30, 31, 32, 33]等通过提高复杂度的工作陆续被提出，我们使用[22]提出的全连接的配对CRF，计算更有效，并能够捕获细微的边缘细节，同时也适应长距离的依赖。[22]中的模型很大程度上提高了基于增强像素级分类器的性能。本文展示了当与基于DCNN的像素级别分类器相结合时，有更好的结果。
![Figure 1]()
&emsp;本文提出的DeepLab基本原理如图1所示。用作分类任务的VGG-16和ResNet-101预训练之后，备用做语义分割任务。(1)把所有全连接层改为全卷积层。(2)用孔洞卷积提高特征分辨率，使得我们能够计算每8个像素计算一个特征，而不是32个像素。然后我们使用双线性插值使得上采样8倍，匹配原输入大小，并作为全连接CRF的输入。
我们的Deeplab有以下几个有点：
- 速度:凭借多孔卷积，我们的密集DCNN在NVidia Titan X GPU上以8 FPS运行，同时全连接CRF的Mean Field Inference在CPU上需要0.5秒
- 准确性:我们在几个具有挑战性的数据集上取得最好结果，包括PASCAL VOC 2012语义分割基准[34]，PASCAL-Context[35]，PASCAL-Person-Part[36]和Cityscapes[37]]
- 简单性:系统由两个非常完善的模块，DCNN和CRF级联组成。
&emsp;本文中提到的DeepLab系统与原始会议中发布的第一个版本[38]相比，具有几个改进。新版本可通过多尺度输入处理[17]，[39]，[40]或者所提出的ASPP技术来更好地分割多尺度的物体。通过采用最新的ResNet [11]图像分类DCNN构建了DeepLab的残差网络变体，与原始基于VGG-16的模型相比，实现了更好的语义分割性能[4]。最后对多个模型变体进行了更全面的实验评估，不仅在PASCAL VOC 2012基准测试中，还针对其他具有挑战性的任务得出了最好的结果。用Caffe框架来实现这些方法[41]。在 http://liangchiehchen.com/projects/DeepLab.html 上分享了代码和模型。
### 2. 相关工作
&emsp;在过去十年中开发的大多数成功的语义分割系统都依赖于手工设计特征的单一分类器(如Boosting[24, 42]，Random Forests[43]或Support Vector Machines[44])的结合。通过从上下文[45]和结构化预测技术[22, 26, 27, 46]中收集更丰富的信息已经实现了显著的改进，但是这些系统的性能一直受到特征的有限表达力的影响。在过去几年中，深度学习从图像分类中的迅速突破转移到了语义分割任务中。由于这个任务涉及分割和分类，所以核心问题是如何组合这两个任务。
&emsp;用于语义分割的基于DCNN的第一类系统通常采用自下而上的级联的图像分割，然后是基于DCNN的区域分类。例如[47]，[48]提供的边界框候选和掩码区域在[7]和[49]中被用作DCNN的输入，整合形状信息给分类过程。类似地，[50]的作者采用超像素表示。即使这些方法可以通过良好的分割得到的尖锐边界受益，但是它们也无法从任何错误中恢复。
&emsp;第二类作品依赖于使用卷积计算的DCNN特征进行密集图像标注，并将它们与独立获得的分割结合在一起。其中[39]首先在多个图像分辨率下应用DCNN，然后采用分割树来平滑预测结果。最近，[21]提出使用skip层并连接DCNN内的中间特征图进行像素分类。此外，[51]建议按局部候选池化中间特征图。这些方法仍然采用从DCNN分类器结果分离的分割算法，因此会过早承担决策风险。
&emsp;第三类作品使用DCNN直接提供密集的类别级的像素标签，以至于可以完全丢弃分割。[14]，[52]的免分割方法直接将DCNN以完全卷积的方式应用于整个图像，将DCNN的最后全连接层转换为卷积层。为了处理引言中概述的空间定位问题，[14]对来自中间特征图的分数进行上采样并连接，[52]通过将粗略结果传播到另一个DCNN，从粗到细优化分预测结果。我们在这些作品的基础上，通过对特征分辨率进行控制来扩展它们，引入多尺度池化技术并将[2密集连接的CRF集成在DCNN之上。我们发现它产生了明显地更好的分割结果，特别是在物体边界处。DCNN和CRF的组合当然不是新的，但以前的工作只尝试了局部连接的CRF模型。具体来说，[53]使用CRF作为基于DCNN的重排系统，而[39]将超像素视为局部配对的CRF节点，并使用图切割进行离散推理。因此，它们的模型受限于超像素计算中的错误或忽略的长距离依赖关系。我们将每个像素看作是由DCNN接收一元势能的CRF节点。重要的是，[22]的全连接CRF模型中的高斯CRF势能可以捕获长距离依赖性，同时该模型适合于快速平均场推理。我们注意到，传统的图像分割任务已经广泛研究了平均场推理[54]，[55]，[56]，但是这些较旧的模型通常限于短距离连接。在某些独立工作中，[57]使用了非常相似的密集连接的CRF模型来改进材料分类问题的DCNN结果。然而，[57]的DCNN模块仅通过稀疏点监督进行训练，而不是每个像素的密集监督。
&emsp;多个团体取得了重大进展，大大提高了PASCAL VOC 2012语义分割基准的水平，反映在基准测试排行榜的高水平论文，如[17]，[40]，[58]，[59]，[60] ]，[61]，[62]，[63]。http://host.robots.ox.ac.uk:8080/leaderboard/displaylb.php?challengeid=11&compid=6。有趣的是，大多数表现好的方法都采用了DeepLab系统的一个或两个关键点:多孔卷积，用于通过全连接的CRF进行有效的密集特征提取和细化原始DCNN分数。我们在下面概述一些最重要和有趣的进展。
&emsp;结构化预测的端到端训练最近在几项相关工作中得到探讨。虽然我们使用CRF作为后端处理方法，[40]，[59]，[62]，[64]，[65]已经成功地进行了DCNN和CRF的联合学习。特别地，[59]，[65]展开了CRF均值场推理步骤，将整个系统转换成端对端可训练的前馈网络，而[62]用卷积滤波器近似估计密集CRF平均值场推理的一次迭代。[40]，[66]另一个富有成效的方向追求，通过学习配对的DCNN-CRF条件，以更巨大的计算代价大大提高了性能。在另一个不同的方向，[63]将平均场推断中使用的双边滤波模块替换为更快的域变换模块[67]，提高了整个系统的速度并降低了存储器要求，[18]，[68]将语义分割与边缘检测相结合。
&emsp;基于弱监督的论文有许多，放宽像素级语义标注到整个训练集[58]，[69]，[70]，[71]，得到比弱监督的预训练的DCNN系统更好的结果，如[72]。在另一个研究领域，[49]，[73]追求实体分割，同时处理物体检测和语义分割。
&emsp;我们所说的多孔卷积，最初是为了高效计算[15]中的多孔变换/非抽取小波变换。感兴趣的读者可参考[74]。多孔卷积也与多比例信号处理中的(多采样率系统中用于将抽取器或插值器移动到合适位置)密切相关，多重比例信号处理建立在输入信号和滤波器采样率相互作用上，如[75]。很多作者在DCNNs中使用相同的操作进行更密集的特征提取，如[3]，[6]，[16]。除了简单的增强分辨率，多孔卷积允许我们扩大滤波器的视野，以纳入更多的上下文内容，[38]中已经表明这是有益的。这种方法已经被[76]进一步改进，他们采用一系列采样率不断增大的多孔卷积来聚合多尺度上下文。这里提出的用于捕获多尺度物体和上下文的多孔空间金字塔池化方案，也采用了具有不同采样率的多个多孔卷积层，但是它们是并行排列而不是串行的。有趣的是，在更广泛的任务中，例如物体检测[12]，[77]，实体分割[78]，视觉问答[79]和光流[80]，也采用了多孔卷积技术。




